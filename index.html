<script>
const whatsapp="https://wa.me/6287798652617?text=I%20choose%20you%20â¤ï¸";

const yesBtn=document.getElementById("yes");
const noBtn=document.getElementById("no");

const music=document.getElementById("music");
const clickSound=document.getElementById("clickSound");
const noSound=document.getElementById("noSound");
const typingSound=document.getElementById("typingSound");
const heartbeat=document.getElementById("heartbeat");
const confettiSound=document.getElementById("confettiSound");

let scale=1;

noBtn.addEventListener("click",()=>{
  noSound.currentTime=0;
  noSound.play().catch(()=>{});

  const x=Math.random()*window.innerWidth*0.8;
  const y=Math.random()*window.innerHeight*0.8;
  noBtn.style.left=x+"px";
  noBtn.style.top=y+"px";

  scale+=0.25;
  yesBtn.style.transform=`scale(${scale})`;
});

yesBtn.addEventListener("click",()=>{

  // ðŸ”¥ beri waktu supaya suara tidak kepotong
  clickSound.currentTime=0;
  clickSound.play().catch(()=>{});

  setTimeout(startLetter,150);
});

function startLetter(){

  document.body.innerHTML=`
  <div class="letter">
    <h1 style="text-align:center">For Abdullah ðŸ’—</h1>
    <div id="type"></div>
  </div>

  <div id="overlay" class="overlay">
    <p id="l1" class="fade">And if you still choose me...</p>
    <p id="l2" class="fade">After the distance,</p>
    <p id="l3" class="fade">After my flaws,</p>
    <p id="l4" class="fade">After the storms I bring into our sky,</p>
    <p id="l5" class="fade">After everything...</p>

    <h2 id="big" class="fade" style="margin-top:20px;">
      Will you be my Valentine? ðŸ’•
    </h2>

    <button id="finalYes" class="fade glow"
      style="margin-top:20px;padding:15px 35px;font-size:22px;
      border:none;border-radius:14px;background:#ff4d6d;color:white;cursor:pointer;">
      YES ðŸ’–
    </button>
  </div>
  `;

  music.play().catch(()=>{});

  const text = `
Dear My love of my life,<br><br>
To you, standing far away from me, separated by thousands of kilometers, yet somehow living in every beat of my heart.<br><br>

Thank you for staying with me this far.
Thank you for holding my hand even when itâ€™s hard, for becoming a home for all my worries, my chaos, and every small piece of me.
Thank you for loving me while knowing I am far from perfect.<br><br>

Iâ€™m sorry I havenâ€™t become the version of myself that you truly deserve.
Iâ€™m sorry if my love still feels smaller than what you give to me.
And Iâ€™m sorry you must face my moods â€” my pessimistic thoughts, my impatience, my endless complaints, the weight I carry, my tears, and the many flaws I am still learning to fix.<br><br>

Through every storm that I sometimes bring into our sky, you stay.
And that means more than I could ever explain.<br><br>

These months with you have been a journey of highs and lows, laughter and breakdowns, warm hugs through a cold distance.
It is not easy â€” loving me is not easy â€” but you are still here.<br><br>

Thank you.
From the deepest part of my heart, thank you.<br><br>

I am so grateful you walked into my life and painted it with colors I never knew existed.
You are, and will always be, the most beautiful gift I have ever received.<br><br>

Your Baby ðŸ’—
`;

  const target=document.getElementById("type");
  let i=0;

  function typeWriter(){
    if(i<text.length){

      // lebih cepat & terasa sinkron
      typingSound.currentTime=0;
      typingSound.play().catch(()=>{});

      if(text.substring(i,i+4)==="<br>"){
        target.innerHTML+="<br>";
        i+=4;
      } else {
        target.innerHTML+=text.charAt(i);
        i++;
      }

      setTimeout(typeWriter,22);
    } else {
      setTimeout(showOverlay,2000);
    }
  }

  function showOverlay(){
    overlay.style.opacity=1;
    setTimeout(()=>l1.classList.add("show"),2000);
    setTimeout(()=>l2.classList.add("show"),3500);
    setTimeout(()=>l3.classList.add("show"),5000);
    setTimeout(()=>l4.classList.add("show"),6500);
    setTimeout(()=>l5.classList.add("show"),8000);

    // â¤ï¸ heartbeat jelas
    setTimeout(()=>{
      heartbeat.volume=1;
      heartbeat.currentTime=0;
      heartbeat.play().catch(()=>{});
      document.body.classList.add("shake");
    },9000);

    setTimeout(()=>{
      big.classList.add("show");
      big.classList.add("zoom");
    },10000);

    setTimeout(()=>finalYes.classList.add("show"),12000);
  }

  typeWriter();

  document.addEventListener("click",e=>{
    if(e.target && e.target.id==="finalYes"){
      heartbeat.pause();
      document.body.classList.remove("shake");

      confettiSound.currentTime=0;
      confettiSound.play().catch(()=>{});

      for(let i=0;i<120;i++){
        const c=document.createElement("div");
        c.innerHTML="ðŸŽ‰";
        c.style.position="fixed";
        c.style.left=Math.random()*100+"vw";
        c.style.top="-10px";
        c.style.fontSize=(Math.random()*20+10)+"px";
        c.style.animation="fall "+(Math.random()*2+2)+"s linear forwards";
        document.body.appendChild(c);
        setTimeout(()=>c.remove(),4000);
      }

      setTimeout(()=>window.location.href=whatsapp,2000);
    }
  });
}
</script>
